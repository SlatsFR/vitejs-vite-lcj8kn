import{SvelteComponent as e,init as s,safe_not_equal as r,empty as o,insert as t,group_outros as a,transition_out as l,check_outros as c,transition_in as i,detach as n,afterUpdate as m,noop as d,subscribe as p,create_component as u,space as f,mount_component as k,destroy_component as j,element as b,attr as g,construct_svelte_component as $,binding_callbacks as v,bind as _,add_flush_callback as h}from"../../../node_modules/svelte/internal/index.js";import x from"../components/primitives/alert/alert.js";import y from"../components/primitives/button/button.js";import w from"../components/_utilities/locale-strings.js";import{mapStepToStage as E}from"./_utilities/map-stage.utilities.js";import I from"../components/primitives/spinner/spinner.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/auth/index.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/auth/enums.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/config/index.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/event/index.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/index.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/index.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/attribute-input-callback.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/choice-callback.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/confirmation-callback.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/device-profile-callback.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/hidden-value-callback.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/kba-create-callback.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/metadata-callback.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/name-callback.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/password-callback.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/polling-wait-callback.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/recaptcha-callback.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/redirect-callback.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/select-idp-callback.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/suspended-text-output-callback.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/terms-and-conditions-callback.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/text-input-callback.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/text-output-callback.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/validated-create-password-callback.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/validated-create-username-callback.js";import{StepType as S}from"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/enums.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/fr-login-failure.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/fr-login-success.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/fr-step.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-device/index.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-policy/index.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-policy/message-creator.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-user/index.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/fr-webauthn/index.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/http-client/index.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/oauth2-client/index.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/session-manager/index.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/token-manager/index.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/token-storage/index.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/user-manager/index.js";import"../../../node_modules/@forgerock/javascript-sdk/lib-esm/util/pkce.js";function C(e){let s,r,o,a;return s=new x({props:{id:"unrecoverableStepError",needsFocus:e[3],type:"error",$$slots:{default:[M]},$$scope:{ctx:e}}}),o=new y({props:{style:"secondary",onClick:e[6],$$slots:{default:[A]},$$scope:{ctx:e}}}),{c(){u(s.$$.fragment),r=f(),u(o.$$.fragment)},m(e,l){k(s,e,l),t(e,r,l),k(o,e,l),a=!0},p(e,r){const t={};8&r&&(t.needsFocus=e[3]),256&r&&(t.$$scope={dirty:r,ctx:e}),s.$set(t);const a={};256&r&&(a.$$scope={dirty:r,ctx:e}),o.$set(a)},i(e){a||(i(s.$$.fragment,e),i(o.$$.fragment,e),a=!0)},o(e){l(s.$$.fragment,e),l(o.$$.fragment,e),a=!1},d(e){j(s,e),e&&n(r),j(o,e)}}}function F(e){let s,r,o;return r=new I({props:{colorClass:"tw_text-primary-light",layoutClasses:"tw_h-28 tw_w-28"}}),{c(){s=b("div"),u(r.$$.fragment),g(s,"class","tw_text-center tw_w-full tw_py-4")},m(e,a){t(e,s,a),k(r,s,null),o=!0},p:d,i(e){o||(i(r.$$.fragment,e),o=!0)},o(e){l(r.$$.fragment,e),o=!1},d(e){e&&n(s),j(r)}}}function N(e){let s,r,m,d;const p=[z,q],u=[];function f(e,s){return e[4].step?e[4].step.type===S.Step?1:-1:0}return~(s=f(e))&&(r=u[s]=p[s](e)),{c(){r&&r.c(),m=o()},m(e,r){~s&&u[s].m(e,r),t(e,m,r),d=!0},p(e,o){let t=s;s=f(e),s===t?~s&&u[s].p(e,o):(r&&(a(),l(u[t],1,1,(()=>{u[t]=null})),c()),~s?(r=u[s],r?r.p(e,o):(r=u[s]=p[s](e),r.c()),i(r,1),r.m(m.parentNode,m)):r=null)},i(e){d||(i(r),d=!0)},o(e){l(r),d=!1},d(e){~s&&u[s].d(e),e&&n(m)}}}function M(e){let s,r;return s=new w({props:{html:!0,key:"unrecoverableError"}}),{c(){u(s.$$.fragment)},m(e,o){k(s,e,o),r=!0},p:d,i(e){r||(i(s.$$.fragment,e),r=!0)},o(e){l(s.$$.fragment,e),r=!1},d(e){j(s,e)}}}function A(e){let s,r;return s=new w({props:{key:"tryAgain"}}),{c(){u(s.$$.fragment)},m(e,o){k(s,e,o),r=!0},p:d,i(e){r||(i(s.$$.fragment,e),r=!0)},o(e){l(s.$$.fragment,e),r=!1},d(e){j(s,e)}}}function q(e){let s,r,m,d;function p(s){e[7](s)}var f=E(e[4].step);function b(e){let s={displayIcon:e[1],failureMessage:e[4].error?.message,loading:e[4].loading,submitForm:e[5],step:e[4].step};return void 0!==e[0]&&(s.formEl=e[0]),{props:s}}return f&&(s=$(f,b(e)),v.push((()=>_(s,"formEl",p)))),{c(){s&&u(s.$$.fragment),m=o()},m(e,r){s&&k(s,e,r),t(e,m,r),d=!0},p(e,o){const t={};if(2&o&&(t.displayIcon=e[1]),16&o&&(t.failureMessage=e[4].error?.message),16&o&&(t.loading=e[4].loading),16&o&&(t.step=e[4].step),!r&&1&o&&(r=!0,t.formEl=e[0],h((()=>r=!1))),f!==(f=E(e[4].step))){if(s){a();const e=s;l(e.$$.fragment,1,0,(()=>{j(e,1)})),c()}f?(s=$(f,b(e)),v.push((()=>_(s,"formEl",p))),u(s.$$.fragment),i(s.$$.fragment,1),k(s,m.parentNode,m)):s=null}else f&&s.$set(t)},i(e){d||(s&&i(s.$$.fragment,e),d=!0)},o(e){s&&l(s.$$.fragment,e),d=!1},d(e){e&&n(m),s&&j(s,e)}}}function z(e){let s,r,o;return r=new I({props:{colorClass:"tw_text-primary-light",layoutClasses:"tw_h-28 tw_w-28"}}),{c(){s=b("div"),u(r.$$.fragment),g(s,"class","tw_text-center tw_w-full tw_py-4")},m(e,a){t(e,s,a),k(r,s,null),o=!0},p:d,i(e){o||(i(r.$$.fragment,e),o=!0)},o(e){l(r.$$.fragment,e),o=!1},d(e){e&&n(s),j(r)}}}function B(e){let s,r,m,d;const p=[N,F,C],u=[];function f(e,s){return e[4]?.completed?e[4]?.successful?1:2:0}return s=f(e),r=u[s]=p[s](e),{c(){r.c(),m=o()},m(e,r){u[s].m(e,r),t(e,m,r),d=!0},p(e,[o]){let t=s;s=f(e),s===t?u[s].p(e,o):(a(),l(u[t],1,1,(()=>{u[t]=null})),c(),r=u[s],r?r.p(e,o):(r=u[s]=p[s](e),r.c()),i(r,1),r.m(m.parentNode,m))},i(e){d||(i(r),d=!0)},o(e){l(r),d=!1},d(e){u[s].d(e),e&&n(m)}}}function D(e,s,r){let o,t=d,a=()=>(t(),t=p(i,(e=>r(4,o=e))),i);e.$$.on_destroy.push((()=>t()));let{displayIcon:l}=s,{formEl:c=null}=s,{journeyStore:i}=s;a();let n=!1;return m((()=>{r(3,n=!o.successful)})),e.$$set=e=>{"displayIcon"in e&&r(1,l=e.displayIcon),"formEl"in e&&r(0,c=e.formEl),"journeyStore"in e&&a(r(2,i=e.journeyStore))},[c,l,i,n,o,function(){i?.next(o.step)},function(){i?.reset(),i?.next()},function(e){c=e,r(0,c)}]}class G extends e{constructor(e){super(),s(this,e,D,B,r,{displayIcon:1,formEl:0,journeyStore:2})}}export{G as default};