import{get_store_value as e,SvelteComponent as s,init as o,safe_not_equal as r,binding_callbacks as a,bind as t,element as i,create_component as c,attr as l,insert as n,mount_component as d,add_flush_callback as m,transition_in as u,transition_out as k,detach as p,destroy_component as f,createEventDispatcher as j,onMount as b}from"./node_modules/svelte/internal/index.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/auth/index.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/auth/enums.js";import g from"./node_modules/@forgerock/javascript-sdk/lib-esm/config/index.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/event/index.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/index.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/index.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/attribute-input-callback.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/choice-callback.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/confirmation-callback.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/device-profile-callback.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/hidden-value-callback.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/kba-create-callback.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/metadata-callback.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/name-callback.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/password-callback.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/polling-wait-callback.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/recaptcha-callback.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/redirect-callback.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/select-idp-callback.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/suspended-text-output-callback.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/terms-and-conditions-callback.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/text-input-callback.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/text-output-callback.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/validated-create-password-callback.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/callbacks/validated-create-username-callback.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/enums.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/fr-login-failure.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/fr-login-success.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-auth/fr-step.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-device/index.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-policy/index.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-policy/message-creator.js";import v from"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-user/index.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/fr-webauthn/index.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/http-client/index.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/oauth2-client/index.js";import h from"./node_modules/@forgerock/javascript-sdk/lib-esm/session-manager/index.js";import _ from"./node_modules/@forgerock/javascript-sdk/lib-esm/token-manager/index.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/token-storage/index.js";import y from"./node_modules/@forgerock/javascript-sdk/lib-esm/user-manager/index.js";import"./node_modules/@forgerock/javascript-sdk/lib-esm/util/pkce.js";import x from"./src/lib/journey/journey.js";import w from"./src/lib/config.js";import{initialize as $}from"./src/lib/journey/journey.store.js";import{initialize as z}from"./src/lib/locale.store.js";import{initialize as U}from"./src/lib/links.store.js";import{initialize as I}from"./src/lib/oauth/oauth.store.js";import{initialize as C}from"./src/lib/user/user.store.js";import{initialize as E}from"./src/lib/style.store.js";function T(e){let s,o,r,j;function b(s){e[6](s)}let g={displayIcon:e[0]?.stage?.icon??!0,journeyStore:e[2]};return void 0!==e[1]&&(g.formEl=e[1]),o=new x({props:g}),a.push((()=>t(o,"formEl",b))),{c(){s=i("div"),c(o.$$.fragment),l(s,"class","fr_widget-root")},m(e,r){n(e,s,r),d(o,s,null),j=!0},p(e,[s]){const a={};1&s&&(a.displayIcon=e[0]?.stage?.icon??!0),!r&&2&s&&(r=!0,a.formEl=e[1],m((()=>r=!1))),o.$set(a)},i(e){j||(u(o.$$.fragment,e),j=!0)},o(e){k(o.$$.fragment,e),j=!1},d(e){e&&p(s),f(o)}}}let L,S,W,F,M,P;const R={start(e){const s=e?.oauth||!0,o=e?.user||!0;let r,a,t=S.subscribe((e=>{!s&&e.successful?M&&M({journey:e}):s&&e.successful?(r=e,W.get({forceRenew:!0})):e.error&&(r=e,F&&F({journey:e})),e.completed&&t()})),i=W.subscribe((e=>{!o&&e.successful?M&&M({journey:r,oauth:e}):o&&e.successful?(a=e,P.get()):e.error&&(a=e,F&&F({journey:r,oauth:e})),e.completed&&i()})),c=P.subscribe((e=>{e.successful?M&&M({journey:r,oauth:a,user:e}):e.error&&F&&F({journey:r,oauth:a,user:e}),e.completed&&c()}));e?.resumeUrl?S.resume(e.resumeUrl):S.start({...e?.config,tree:e?.journey})},onFailure(e){F=s=>e(s)},onSuccess(e){M=s=>e(s)}},q={onMount(e){L=s=>e(s)}},A={authorized:async(e=!1)=>e?!!await y.getCurrentUser():!!await _.getTokens(),info:async(s=!1)=>s?await y.getCurrentUser():e(P).response,async logout(){const{clientId:e}=g.get();e?await v.logout():await h.logout(),S.reset(),W.reset(),P.reset(),R.start()},tokens:async e=>await _.getTokens(e)};function B(e,s,o){let{config:r}=s,{content:a}=s,{links:t}=s,{style:i}=s;const c=j();let l;w({clientId:"WebLoginWidgetClient",realmPath:"alpha",redirectUri:"object"==typeof window?window.location.href:"https://localhost:3000/callback",scope:"openid email",tree:"Login",...r,support:"legacy"});let n=S=$(r);return W=I(r),P=C(r),z(a),U(t),E(i),b((()=>{L&&L(l),setTimeout((()=>{c("form-mount",l)}),0)})),e.$$set=e=>{"config"in e&&o(3,r=e.config),"content"in e&&o(4,a=e.content),"links"in e&&o(5,t=e.links),"style"in e&&o(0,i=e.style)},[i,l,n,r,a,t,function(e){l=e,o(1,l)}]}class D extends s{constructor(e){super(),o(this,e,B,T,r,{config:3,content:4,links:5,style:0})}}export{D as default,q as form,R as journey,A as user};